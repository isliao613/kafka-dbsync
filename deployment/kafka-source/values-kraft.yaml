kafka:
  # KRaft mode configuration for Kafka 4.0
  # This chart uses KRaft by default (no Zookeeper required)

  ## Global parameters
  global:
    imageRegistry: ""
    imagePullSecrets: []
    defaultStorageClass: ""
    security:
      allowInsecureImages: true

  ## Kafka image - using ECR public registry (docker.io/bitnami requires subscription)
  image:
    registry: public.ecr.aws
    repository: bitnami/kafka
    tag: 3.9.0-debian-12-r4
    pullPolicy: IfNotPresent

  ## KRaft configuration
  # clusterId will be auto-generated on first initialization if not set
  clusterId: ""
  # kraftVersion: 0 = static quorum (controller.quorum.voters), 1 = dynamic quorum
  # Using static quorum for Kafka 3.9 compatibility
  kraftVersion: 0

  ## Listener configuration
  ## Client listener uses SASL_PLAINTEXT for authentication
  ## Controller and interbroker remain PLAINTEXT (internal only)
  listeners:
    client:
      containerPort: 9092
      protocol: SASL_PLAINTEXT
      name: CLIENT
    controller:
      name: CONTROLLER
      containerPort: 9093
      protocol: PLAINTEXT
    interbroker:
      containerPort: 9094
      protocol: PLAINTEXT
      name: INTERNAL
    external:
      containerPort: 9095
      protocol: PLAINTEXT
      name: EXTERNAL

  ## SASL configuration
  ## admin: super user for MM2 connectors, producers, and admin operations
  ## readonly: read-only access to specific topics (ACLs configured separately)
  sasl:
    enabledMechanisms: PLAIN,SCRAM-SHA-256,SCRAM-SHA-512
    interBrokerMechanism: PLAIN
    controllerMechanism: PLAIN
    client:
      users:
        - admin
        - readonly
      passwords: "admin-secret,readonly-secret"

  ## TLS configuration - disabled for development
  tls:
    type: JKS
    autoGenerated:
      enabled: false

  ## Controller-eligible nodes configuration
  controller:
    # Number of controller-eligible nodes (minimum 1 for development)
    replicaCount: 1
    # When false, controller nodes also act as brokers
    controllerOnly: false
    # Minimum node ID for controllers
    minId: 0

    ## Override configuration for single-broker development setup
    ## These settings are merged into the controller's server.properties
    overrideConfiguration:
      offsets.topic.replication.factor: "1"
      offsets.topic.num.partitions: "1"
      transaction.state.log.replication.factor: "1"
      transaction.state.log.min.isr: "1"
      default.replication.factor: "1"
      min.insync.replicas: "1"
      num.partitions: "1"
      ## ACL authorization
      ## ANONYMOUS is super user for PLAINTEXT internal listeners (controller, interbroker)
      authorizer.class.name: "org.apache.kafka.metadata.authorizer.StandardAuthorizer"
      super.users: "User:admin;User:ANONYMOUS"
      allow.everyone.if.no.acl.found: "false"

    ## Persistence configuration
    persistence:
      enabled: true
      storageClass: ""
      accessModes:
        - ReadWriteOnce
      size: 8Gi

    ## Resource configuration
    resourcesPreset: "small"

  ## Broker-only nodes configuration (separate from controllers)
  broker:
    # No separate broker nodes - controllers act as brokers
    replicaCount: 0

    ## Persistence configuration
    persistence:
      enabled: true
      storageClass: ""
      accessModes:
        - ReadWriteOnce
      size: 8Gi

  ## Service configuration
  service:
    type: ClusterIP
    ports:
      client: 9092
      controller: 9093
      interbroker: 9094
      external: 9095

  ## External access - disabled for development
  externalAccess:
    enabled: false

  ## Metrics configuration
  metrics:
    kafka:
      enabled: false
    jmx:
      enabled: false
    serviceMonitor:
      enabled: false

  ## Provisioning - disabled
  provisioning:
    enabled: false

  ## Network policy - disabled for development
  networkPolicy:
    enabled: false

  ## Log cleanup policy
  logCleanupPolicy: compact
